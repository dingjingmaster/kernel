# CPU之大小端

计算机架构中，“大小端”(Endianness)是描述多字节数据存储方式的概念，主要分为以下两种：
- 小端模式
- 大端模式

## 小端模式

低位字节在前，高位字节在后。在内存中，数据的最低有效字节(Least Significant Byte, LSB)存储在最低地址处，最高有效字节(Most Significant Byte, MSB)存储在最高地址处。

例如：32位整数 `0x12345678` 的存储方式如下：
```
地址：0x00  0x01  0x02  0x03
数据：0x78  0x56  0x34  0x12
```

## 大端模式

高位字节在前，低位字节在后。在内存中，数据的最高有效字节存储在最低地址处，最低有效字节存储在最高地址处。

例如：32位整数 `0x12345678` 的存储方式如下：
```
地址：0x00  0x01  0x02  0x03
数据：0x12  0x34  0x56  0x78
```

## CPU 对大小端的支持

- 小端架构的CPU：x86 和 x86_64
- 大端架构的CPU：早期的RISC架构(如IBM的PowerPC和一些嵌入式架构)
- 双端架构的CPU：一些处理器(如：ARM、SPARC)支持大端和小端模式，可以根据需求切换

## 使用场景

1. 大多数网络协议(如：TCP/IP)使用大端格式，称为网络字节序
2. 数据文件的大小端依赖于存储格式的设计，可能是大端也可能是小端
3. 不同架构之间的大小端差异可能导致数据解析问题，因此需要在序列化和反序列化时候处理字节序

## 大小端判断

```c
#include <stdio.h>

int main (void)
{
    unsigned int x = 1;
    char* c = (char*) &x;

    if (*c) {
        printf ("Little Endian\n");
    }
    else {
        printf ("Big Endian\n");
    }

    return 0;
}
```
