# RCU

允许多个读操作并发执行，写操作通过复制数据结构实现。适用于读多写少且需避免锁竞争的场景，如路由表更新

`struct rcu_state` 和 `struct rcu_node` 定义在: `include/linux/rcupdate.h`和`kernel/rcu/tree.h`中

## 实现

- RCU链表

## 典型应用场景

- 文件系统：并发访问目录结构（如inode管理），提升查找效率。
- 内存管理：动态分配器（kmalloc）通过RCU优化引用计数。
- 网络协议栈：并发处理数据包时保护路由表、连接状态等数据结构

## 注意问题

- RCU饥饿问题：写者频繁更新可能导致宽限期延长，可通过调整调度策略或限制读者数量缓解。
- 回调延迟：系统负载高时，call_rcu()注册的回调可能延迟执行，需优化回调逻辑。
- 不可抢占内核限制：RCU读操作在不可抢占内核中无开销，但需确保临界区代码无阻塞
